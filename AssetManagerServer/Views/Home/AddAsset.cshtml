@using AssetManagerServer.Models
@model dynamic

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <link rel="stylesheet"
              href="https://unpkg.com/purecss@2.0.6/build/pure-min.css"
              integrity="sha384-Uu6IeWbM+gzNVXJcM9XV3SohHtmWE+3VGi496jvgX1jyvDTXfdK+rfZc8C1Aehk5"
              crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Добавление актива</title>
</head>
<body>
<div>
    <h3>Invest Manager Inc.</h3>
    <form method="post" action="" class="pure-form pure-form-aligned">
        @{
            var brokers = new List<Broker>();
            foreach (var broker in ViewBag.Brokers)
            {
                brokers.Add(new Broker(broker as Broker));
            }
            
            Operation patternOperation;
            if (ViewBag.OperationId != -1)
            {
                var operations = new List<Operation>();
                foreach (var o in ViewBag.Operations)
                {
                    operations.Add(new Operation(o as Operation));
                }
                patternOperation = operations.FirstOrDefault(operation => operation.Id == ViewBag.OperationId);
            }
            else
            {
                patternOperation = null;
            }
        }
        <fieldset>
            <input type="hidden" name="OperationId" value="@(ViewBag.OperationId)"/>
            @Helpers.TextBoxPureStyled("AssetName", "Название актива", @patternOperation?.AssetName)
            @Helpers.TextBoxPureStyled("AssetTicker", "Тикер актива", @patternOperation?.AssetTicker)
            @Helpers.TextBoxPureStyled("AssetType", "Тип актива", @patternOperation?.AssetType)
            @Helpers.TextBoxPureStyled("Datetime", "Дата сделки")
            @Helpers.TextBoxPureStyled("Price", "Цена сделки")
            @Helpers.TextBoxPureStyled("BrokerName", "Брокер", @brokers.FirstOrDefault(broker => broker.Id == patternOperation?.BrokerId)?.Name)
            @Helpers.TextBoxPureStyled("Count", "Кол-во")
            @Helpers.ConfirmButtonPureStyled("Добавить операцию покупки", @ViewBag.NotifyMessage)
        </fieldset>
    </form>
</div>
</body>
</html>